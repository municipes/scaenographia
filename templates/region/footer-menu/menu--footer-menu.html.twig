{#
/**
 * @file
 * Default theme implementation to display a menu.
 *
 * Available variables:
 * - menu_name: The machine name of the menu.
 * - items: A nested list of menu items. Each menu item contains:
 *   - attributes: HTML attributes for the menu item.
 *   - below: The menu item child items.
 *   - title: The menu link title.
 *   - url: The menu link url, instance of \Drupal\Core\Url
 *   - localized_options: Menu link localized options.
 *   - is_expanded: TRUE if the link has visible children within the current
 *     menu tree.
 *   - is_collapsed: TRUE if the link has children within the current menu tree
 *     that are not currently visible.
 *   - in_active_trail: TRUE if the link is in the active trail.
 *
 * @ingroup themeable
 */
#}
{# This section modifies the items array #}
{% set _items = [] %}

{% set map = {
  'leggi le faq': 'faq',
  'segnalazione disservizio': 'report-inefficiency',
  'informativa privacy': 'privacy-policy-link',
  'dichiarazione di accessibilit√†': 'accessibility-link',
  'note legali': 'legal-notes'
} %}

{% for item in items %}

  {% if map[item.title|lower] is not empty %}

    {# Set data-attribute to container (eg. li) #}
    {% set _attributes = item.attributes.setAttribute('data-element', map[item.title|lower]) %}
    {% set _item = item|merge({'attributes': _attributes}) %}

    {# Set data-attribute to url (_attributes is reused for the sake
       of simplicity of the example, if it is deemed appropriate
       to construct another Attributes object.)
    #}
    {% set _url = link(item.title, item.url, _attributes) %}
    {% set _item = _item|merge({'url': _url['#url']}) %}

    {# Merge to _items #}
    {% set _items = _items|merge([_item]) %}

  {% else %}
    {% set _attributes = item.attributes.setAttribute('data-element', 'custom-submenu') %}
    {% set _items = _items|merge([item]) %}
  {% endif %}

{% endfor %}

{# Component. #}
  {% include '@bootstrap_italia/base/menu.html.twig' with {
    menu_name: menu_name,
    items: _items,
    attributes: attributes,
    active_assistive_text: 'Current Page'|t,
    show_link_description: navigation_header_show_link_description,
    active_items_large: navigation_header_active_items_large,
    active_items_bold: navigation_header_active_items_bold,
    megamenu_responsive_columns: (navigation_header_megamenu_columns_lg ~ ' ' ~ navigation_header_megamenu_columns_xl)|trim,
    verbose_classes: navigation_header_verbose_classes,
  } %}
