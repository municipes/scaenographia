{# Icone Star #}
<svg xmlns="http://www.w3.org/2000/svg">
     <symbol id="it-star-full" viewBox="0 0 24 24">
         <path
             d="M12 1.7L9.5 9.2H1.6L8 13.9l-2.4 7.6 6.4-4.7 6.4 4.7-2.4-7.6 6.4-4.7h-7.9L12 1.7z"></path>
     </symbol>
     <symbol id="it-star-outline" viewBox="0 0 24 24">
         <path
             d="M12 4.9l1.5 4.6.2.7h5.7l-4 2.9-.6.4.2.7 1.5 4.7-3.9-2.9-.6-.4-.6.4-3.9 2.9L9 14.2l.2-.7-.6-.4-4-2.9h5.7l.2-.7L12 4.9m0-3.2L9.5 9.2H1.6L8 13.9l-2.4 7.6 6.4-4.7 6.4 4.7-2.4-7.6 6.4-4.7h-7.9L12 1.7z"></path>
     </symbol>
</svg>

{# Modulo HTML #}
<div class="bg-primary" id="partial-url-container" data-partial-url="{{ path('<current>') }}">
  <div class="container">
    <div class="row d-flex justify-content-center bg-primary">
      <div class="col-12 col-lg-6 p-lg-0 px-3">
        <div class="cmp-rating pt-lg-80 pb-lg-80" id="rating">
          <div class="card shadow card-wrapper" data-element="feedback">
            <div class="cmp-rating__card-first">
              <div class="card-header border-0">
                <h2 class="title-medium-2-semi-bold mb-0" data-element="feedback-title"> Quanto sono chiare le informazioni su questa pagina? </h2>
              </div>
              <div class="star-card-body">
                <fieldset class="rating"> {% set c = 5 %} {% for i in 1..5 %} <input type="radio" id="{{ 'star' ~ c ~ 'a' }}" name="ratingA" value="{{ c }}" />
                  <label class="full rating-star" for="{{ 'star' ~ c ~ 'a' }}" data-element="{{ 'feedback-rate-' ~ c }}" data-label="{{ c }}">
                    <svg class="icon icon-sm" role="img" aria-labelledby="{{ c }}-star">
                      <use href="#it-star-full"></use>
                    </svg>
                    <span class="visually-hidden" id="{{ c }}-star"> Valuta {{ c }} stelle su 5 </span>
                  </label> {% set c = c - 1 %} {% endfor %}
                </fieldset>
              </div>
            </div>
            <div class="cmp-rating__card-second d-none" data-step="3">
              <div class="card-header border-0">
                <h2 class="title-medium-2-bold mb-0" id="rating-feedback"> Grazie, il tuo parere ci aiuterà a migliorare il servizio! </h2>
              </div>
            </div>
            <div class="form-rating d-none">
              <div class="d-none rating-shadow" data-step="1">
                <div class="cmp-steps-rating">
                  <fieldset class="fieldset-rating-one d-none" data-element="feedback-rating-positive">
                    <legend class="iscrizioni-header w-100">
                      <h3 class="step-title d-flex align-items-center justify-content-between drop-shadow">
                        <span class="d-block d-lg-inline" data-element="feedback-rating-question"> Quali sono stati gli aspetti che hai preferito? </span>
                        <span class="step">1/2</span>
                      </h3>
                    </legend>
                    <div class="cmp-steps-rating__body">
                      <div class="cmp-radio-list">
                        <div class="card-teaser shadow-rating">
                          <div class="card-body">
                            <div class="form-check m-0">
                              <div class="radio-body border-bottom border-light cmp-radio-list__item">
                                <input name="rating1" type="radio" id="radio-1" data-label="Le indicazioni erano chiare" />
                                <label for="radio-1" data-element="feedback-rating-answer"> Le indicazioni erano chiare </label>
                              </div>
                              <div class="radio-body border-bottom border-light cmp-radio-list__item">
                                <input name="rating1" type="radio" id="radio-2" data-label="Le indicazioni erano complete" />
                                <label for="radio-2" data-element="feedback-rating-answer"> Le indicazioni erano complete </label>
                              </div>
                              <div class="radio-body border-bottom border-light cmp-radio-list__item">
                                <input name="rating1" type="radio" id="radio-3" data-label="Capivo sempre che stavo procedendo correttamente" />
                                <label for="radio-3" data-element="feedback-rating-answer"> Capivo sempre che stavo procedendo correttamente </label>
                              </div>
                              <div class="radio-body border-bottom border-light cmp-radio-list__item">
                                <input name="rating1" type="radio" id="radio-4" data-label="Non ho avuto problemi tecnici" />
                                <label for="radio-4" data-element="feedback-rating-answer"> Non ho avuto problemi tecnici </label>
                              </div>
                              <div class="radio-body border-bottom border-light cmp-radio-list__item">
                                <input name="rating1" type="radio" id="radio-5" data-label="Altro" />
                                <label for="radio-5" data-element="feedback-rating-answer"> Altro </label>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </fieldset>
                  <fieldset class="fieldset-rating-two d-none" data-element="feedback-rating-negative">
                    <legend class="iscrizioni-header w-100">
                      <h3 class="step-title d-flex align-items-center justify-content-between drop-shadow">
                        <span class="d-block d-lg-inline" data-element="feedback-rating-question"> Dove hai incontrato le maggiori difficoltà? </span>
                        <span class="step">1/2</span>
                      </h3>
                    </legend>
                    <div class="cmp-steps-rating__body">
                      <div class="cmp-radio-list">
                        <div class="card-teaser shadow-rating">
                          <div class="card-body">
                            <div class="form-check m-0">
                              <div class="radio-body border-bottom border-light cmp-radio-list__item">
                                <input name="rating2" type="radio" id="radio-6" data-label="A volte le indicazioni non erano chiare" />
                                <label for="radio-6" data-element="feedback-rating-answer"> A volte le indicazioni non erano chiare </label>
                              </div>
                              <div class="radio-body border-bottom border-light cmp-radio-list__item">
                                <input name="rating2" type="radio" id="radio-7" data-label="A volte le indicazioni non erano complete" />
                                <label for="radio-7" data-element="feedback-rating-answer"> A volte le indicazioni non erano complete </label>
                              </div>
                              <div class="radio-body border-bottom border-light cmp-radio-list__item">
                                <input name="rating2" type="radio" id="radio-8" data-label="A volte non capivo se stavo procedendo correttamente" />
                                <label for="radio-8" data-element="feedback-rating-answer"> A volte non capivo se stavo procedendo correttamente </label>
                              </div>
                              <div class="radio-body border-bottom border-light cmp-radio-list__item">
                                <input name="rating2" type="radio" id="radio-9" data-label="Ho avuto problemi tecnici" />
                                <label for="radio-9" data-element="feedback-rating-answer"> Ho avuto problemi tecnici </label>
                              </div>
                              <div class="radio-body border-bottom border-light cmp-radio-list__item">
                                <input name="rating2" type="radio" id="radio-10" data-label="Altro" />
                                <label for="radio-10" data-element="feedback-rating-answer">Altro</label>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </fieldset>
                </div>
              </div>
              <div class="d-none" data-step="2">
                <div class="cmp-steps-rating">
                  <fieldset>
                    <legend class="iscrizioni-header w-100">
                      <h3 class="step-title d-flex align-items-center justify-content-between drop-shadow mb-4">
                        <span class="d-block d-lg-inline"> Vuoi aggiungere altri dettagli? </span>
                        <span class="step">2/2</span>
                      </h3>
                    </legend>
                    <div class="cmp-steps-rating__body">
                      <div class="form-group shadow-rating">
                        <label for="formGroupExampleInputWithHelp"> Dettaglio </label>
                        <input class="form-control" id="formGroupExampleInputWithHelp" aria-describedby="formGroupExampleInputWithHelpDescription" maxlength="200" type="text" data-element="feedback-input-text" />
                        <small id="formGroupExampleInputWithHelpDescription" class="form-text"> Inserire massimo 200 caratteri </small>
                      </div>
                    </div>
                  </fieldset>
                </div>
              </div>
              <div class="d-flex flex-nowrap pt-4 w-100 justify-content-center">
                <button class="btn btn-outline-primary fw-bold me-4 btn-back" type="button"> Indietro </button>
                <button class="btn btn-primary fw-bold btn-next" type="submit" form="rating"> Avanti </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{# Stili estrapolati da comune.css #}
<style>.title-medium-2-bold{font-size:1.25rem;font-weight:700;line-height:1.2}.title-medium-2-semi-bold{font-size:1.25rem;font-weight:600;line-height:1.2}.mb-0{margin-bottom:0!important}@media (min-width:576px){.title-medium-2-semi-bold{font-size:1.3333333333rem}.title-medium-2-bold{font-size:1.3333333333rem}}@media (min-width:768px){.title-medium-2-semi-bold{line-height:1.2}.title-medium-2-bold{line-height:1.2}}.cmp-rating{padding:1.5rem 0}@media (min-width:576px){.cmp-rating{padding:1.33rem 0}}.rating>label svg{fill:#7d97b0}.form-group{margin-bottom:0;min-height:5rem}@media (min-width:576px){.form-group{min-height:5.56rem}}.card{padding:1rem}@media (min-width:576px){.card{padding:.89rem}}@media (min-width:992px){.card{padding:1.78rem}}.card::after{content:unset}.card-header{padding:0;margin-bottom:1.25rem}@media (min-width:576px){.card-header{margin-bottom:1.11rem}}.star-card-body{padding:0}.rating input:focus+label{border-color:#f90 !important;box-shadow:0 0 0 2px #f90 !important;outline:none !important}.cmp-steps-rating .step-title{padding:.875rem;margin-bottom:2.375rem}@media (min-width:576px){.cmp-steps-rating .step-title{padding:.78rem;margin-bottom:2.111rem}}.cmp-steps-rating legend{font-size:18px;font-weight:600;line-height:36px;overflow:unset}.iscrizioni-header .drop-shadow{box-shadow:0 .9375rem 1.325rem -0.9rem rgba(0,0,0,.1)}.iscrizioni-header .small-title{font-size:20px;font-weight:600;line-height:1.55}.iscrizioni-header .step-wrapper{font-size:24px;font-weight:700;line-height:1.25}.iscrizioni-header .step-title{font-size:18px;font-weight:600;line-height:2}.iscrizioni-header .step{font-size:14px;font-weight:600;line-height:1.5}.iscrizioni-header .header-text{font-size:16px;font-weight:400;line-height:1.5}.cmp-radio-list{font-size:1rem;font-weight:600}.cmp-radio-list__item:not(:last-child){margin-bottom:1rem}@media (min-width:576px){.cmp-radio-list__item:not(:last-child){margin-bottom:.89rem}}.form-check [type="checkbox"]+label,.form-check [type="radio"]+label{height:auto;margin-bottom:1.25rem}@media (min-width:576px){.form-check [type="checkbox"]+label,.form-check [type="radio"]+label{margin-bottom:1.11rem}}.cmp-rating-section{padding:1.5rem 1rem}@media (min-width:576px){.cmp-rating-section{padding:1.33rem .89rem}}@media (min-width:992px){.cmp-rating-section{padding:4.44rem 0}}</style>
{# Script estrapolato da rating.js che restituisce i dati elaborati nella console in formato JSON #}
<script>var wrapper=document.querySelector(".cmp-rating"),activeStep=0;function initRatings(){var e,t,r;wrapper&&(e=wrapper.querySelectorAll(".rating input"),t=wrapper.querySelector(".btn-next"),r=wrapper.querySelector(".btn-back"),e.forEach(function(e){e.addEventListener("change",function(){resetBlock(),e.checked&&openNextStep()})}),t&&t.addEventListener("click",function(){closePreviousStep(),openNextStep()}),r&&r.addEventListener("click",function(){closePreviousStep(),backToPrevious()}))}function inviaDatiAlServer(){var e=document.getElementById("partial-url-container").getAttribute("data-partial-url"),t=document.querySelector('input[name="ratingA"]:checked');const r=document.querySelector('input[name="rating1"]:checked'),a=document.querySelector('input[name="rating2"]:checked');var c=document.querySelector('[data-element="feedback-input-text"]');const n={};n.feedbackURL=e,n.ratingStar=t?t.value:"",r?n.feedbackStar=r.getAttribute("data-label"):a?n.feedbackStar=a.getAttribute("data-label"):n.feedbackStar="",n.feedbackOther=c?c.value:"";c={feedbackURL:n.feedbackURL,ratingStar:n.ratingStar,feedbackStar:n.feedbackStar,feedbackOther:n.feedbackOther};console.log("Feedback JSON:",JSON.stringify(c,null,2))}function openNextStep(){var e=wrapper.querySelector(".form-rating");e.classList.remove("d-none");var t=document.querySelector('[name="ratingA"]:checked');(3<parseInt(t.value)?document.querySelector(".fieldset-rating-one"):document.querySelector(".fieldset-rating-two")).classList.remove("d-none");t=wrapper.querySelector('[data-step="'.concat(activeStep+1,'"]'));t.classList.remove("d-none"),t.classList.add("active");t=wrapper.querySelectorAll("[data-step]");(activeStep+=1)==t.length&&(t=wrapper.querySelector(".cmp-rating__card-first"),e.classList.add("d-none"),t.classList.add("d-none"),t=new Event("feedback-submit"),document.dispatchEvent(t),inviaDatiAlServer())}function backToPrevious(){var e=wrapper.querySelector(".form-rating");e.classList.remove("d-none"),0==--activeStep?(e.classList.add("d-none"),wrapper.querySelector(".cmp-rating__card-first").classList.remove("d-none"),resetFieldsets(),document.querySelector('[name="ratingA"]:checked').checked=!1):((e=wrapper.querySelector('[data-step="'.concat(activeStep+1,'"]'))).classList.add("d-none"),e.classList.remove("active"),(e=wrapper.querySelector('[data-step="'.concat(activeStep,'"]'))).classList.remove("d-none"),e.classList.add("active"))}function resetBlock(){closePreviousStep(),wrapper.querySelector(".form-rating").classList.add("d-none"),resetFieldsets(),activeStep=0}function resetFieldsets(){var e=document.querySelector(".fieldset-rating-one"),t=document.querySelector(".fieldset-rating-two");e.classList.add("d-none"),t.classList.add("d-none")}function closePreviousStep(){var e=wrapper.querySelector("[data-step].active");e&&(e.classList.add("d-none"),e.classList.remove("active"))}initRatings();</script>
